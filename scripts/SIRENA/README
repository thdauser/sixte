These are example bash scripts to run SIRENA and reconstruct (retrieve ENERGY and arrival TIME) SIXTE/tessim or xifusim simulated files.

1) create_noise_spectrun.sh

Script to simulate noise streams in the same conditions as the data to be reconstructed

2) simulate_pulses_template.sh

Script to simulate isolated pulses at the energy selected to build the optimal filter. 

3) create_library_optfilt.sh 

With the noise spectrum create in script "create_noise_spectrum.sh" and the isolated pulses produced by script "simulate_pulses_template.sh", this script builds the optimal filter (in Frequency and Time domains) with different lengths.

4) example_reconstruction.sh

Example of a SIRENA call to reconstruct your previously simulated data.



================
*** NOTE on XML files    ||
================

SIRENA reconstruction requires a table with GRADING parameters to qualify the reconstructed pulses al High, Medium, Limited or Low resolution. This information is not provided by the xifusim XML files readable by xifusim versions lower than 0.7.0. For this reason 'tessim' or 'xifusim (version <= 0.7.0)' simulated files need and additional XML file to be reconstructed by SIRENA. This file is usually ${SIXTE}/share/sixte/instruments/athena-xifu/xifu_detector_lpa_75um_AR0.5_pixoffset_mux40_pitch275um.xml

For xifusim versions higher than 0.7.0, it is possible to use a single XML file for xifusim simulations and SIRENA reconstructions. In this case, the structure of the XML file should have a root node called 'xifuconfig'   with the 'detector' node being a child thereof. There is also an  optional 'reconstruction' node, on the same level as 'detector'.

The 'reconstruction' node may contain keys for ADU to current  conversion. If they are present, they are added by xifusim to the Trigger  output header (useful for the reconstruction in the quasi-resistance space).
The old structure with the 'detector' node at root is still supported by xifusim.

Example of XML file (common for xifusim>0.7.0 and SIRENA):
========================================

<?xml version="1.0"?>

<xifuconfig>

  <detector model="TDM" filename="pars_tdm.fits" hduname="Lin8_MUX2">
    <TesArray>
      <TES model="LinTES" filename="pars_lpa2.5a.fits" hduname="LPA2.5a"/>
    </TesArray>
    <SQUID model="SineSquid" filename="pars_lpa2.5a.fits" hduname="S_Squid_LPA2.5a"/>
    <WFEE model="LinLNA" filename="pars_lpa2.5a.fits" hduname="LinLNA_LPA2.5a"/>
    <DRE model="TDM_DRE" filename="pars_lpa2.5a.fits"  hduname="TDM_LPA2.5a"/>
    <ADC model="Adc" filename="pars_lpa2.5a.fits" hduname="ADC_12_LPA2.5A"/>
    <Trigger model="TriggerDiff" filename="pars_lpa2.5a.fits" hduname="TrigLPA2.5a"/>
  </detector>

  <reconstruction>
    <ADU_to_I I_BIAS="3.989902e-05" ADU_BIAS="7086.509200" ADU_CNV="-8.328901e-09"/>
    <grading num="1" name="high" pre="1234" post="7080" rmf="athena_xifu_rmf_highres_v20181109.rmf"/>
    <grading num="2" name="mid" pre="1234" post="354" rmf="athena_xifu_rmf_midres_v20181109.rmf"/>
    <grading num="3" name="lim" pre="1234" post="146" rmf="athena_xifu_rmf_limres_v20181109.rmf"/>
    <grading num="4" name="low" pre="1234" post="4" rmf="athena_xifu_rmf_lowres_v20181109.rmf"/>
  </reconstruction>
  
</xifuconfig>
